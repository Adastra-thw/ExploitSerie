from sulley import *
from requests import MiniShareRequest

def init_message (sock):
	init = 'GET /index.html HTML/1.1\r\n\r\n'

sess = sessions.session(session_filename="audits/MiniShare.session")
target = sessions.target("192.168.1.116", 80)
target.netmon = pedrpc.client("192.168.1.116", 26001)
target.procmon = pedrpc.client("192.168.1.116", 26002)
target.procmon_options = { "proc_name" : "minishare.exe", "stop_commands" : ["taskkill /IM minishare.exe"], "start_commands" : ['"C:\MiniShare\minishare.exe"']}

sess.add_target(target)
sess.pre_send = init_message
sess.connect(sess.root, s_get("MiniShare"))
sess.fuzz()
