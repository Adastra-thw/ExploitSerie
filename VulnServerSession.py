from sulley import * # import everything from Sulley
from requests import VulnServerRequest

def receive_banner(sock):
	print sock.recv(1024)

sess = sessions.session(session_filename="audits/VulnServer.session")
target = sessions.target("192.168.1.116", 9999)
target.netmon = pedrpc.client("192.168.1.116", 26001)
target.procmon = pedrpc.client("192.168.1.116", 26002)
target.procmon_options = { "proc_name" : "vulnserver.exe",
							"stop_commands" : ["taskkill /IM vulnserver.exe"]
							"start_commands" : ["start D:\vulnserver\vulnserver.exe"]}

sess.pre_send = receive_banner
sess.add_target(target)
sess.connect(sess.root, s_get("VulnServerFuzzing"))
sess.fuzz()